
- Threat Modeling
	- Identifying and communicating information about the threats that may impact a particular system or network. 
	- Enables an IT Team to understand the nature of threats, as well as how they may impact the network.
- DNSCrypt
-  SQL Injections
	- Input validation
	- Parameterized queries
	- Stored procedures
	- Implementing a WAF (Web Application Firewall) on the perimeter of the server's network

*These could go into their own section somewhere*
Windows
- Endpoint Security Fundamentals
	- Core Windows Processes
		- Examples (parent > child):
			- System
			- System > smss.exe
			- csrss.exe
			- wininit.exe
			- wininit.exe > services.exe
			- wininit.exe > services.exe > svchost.exe
			- lsass.exe
			- winlogon.exe
			- explorer.exe
		- Sysinternals (https://learn.microsoft.com/en-us/sysinternals/)
			- Over 70+ Windows-based tools
			- File and Disk Utilities
			- Networking Utilities
				- TCPView
					- Details listings of all TCP and UDP endpoints on your system (including the local and remote addresses and state of TCP connections. )
					- Subset of the Netstat program
					- Includes TCPvcon
				- Process Utilities
					- Process Explorer
						- Consists of two sub-windows
							- The top always shows a list of the currently active processes
							- Bottom depends if in:
								- handle mode - you'll see the handles that the process selected in the top window has opened
								- DLL mode - you'll see the DLLs and memory-mapped files that the process has loaded
								- Threads Mode - shows the threads that the process has
						- Will show you the process'
							- Associated services
							- Invoked network traffic
							- Handles such as files or directories opened
							- DLLs and memory-mapped files loaded
			- Security Utilities
			- System Information
			- Miscellaneous
- Endpoint Logging and Monitoring
	- Event Logs
		- Raw data can be translated into XML using the Windows API. The events in these log files are stored in a proprietary binary format with a .evt or .evtx extension. 
		- The log files with the .evtx file extension typically reside in:
				C:\Windows>System32>winevt>Logs
		- Three main ways of accessing these event logs within a Windows sytem:
			- Event Viewer (GUI)
			- Wevtutil.exe (CLI)
			- Get-WinEvent (PowerShell)
	- Sysmon
		- A tool used to monitor and log events on Windows
		- Commonly used by enterprises as part of their monitoring and logging solutions
		- Gathers detailed and high-quality logs as well as event tracing that assists in identifying anomalies in your environment. 
		- Commonly used with a Security Information and Event Management (SIEM) system or other log parsing solutions that aggregate, filter and visualize events. 
	- OSQuery
		- Open-source tool created by Facebook. With Osquery - Security Analysts, Incident Responders, and Threat Hunters can query an endpoint (or multiple endpoints) using SQL syntax. OSquery can be installed on various platforms:
			- Linux
			- MacOS
			- Windows
			- FreeBSD
		- OSQuery only allows you to query events inside the machine. But with Kolide Fleet you can query multiple endpoints from the Kolide Fleet UI instead of using OSQuery locally to query events inside the machine. 
	- Kolide Fleet
		- Similar to OSQuery in that it uses SQL queries to identify specific processes that are running on multiple machines. 
	- Wazuh
		- Open-source, freely available, and extensive EndPoint Detection and Response solution - which Security Engineers can deploy in all scales of environments. 
		- An Endpoint Detection and Response (EDR) tool
			- Audit the device for common vulnerabilities
			- Monitor a device for suspicious activity
				- Unauthorised logins
				- Brute-force attacks
				- Privilege escalations
			- Visualising complex data and events into fancy and neat graphs 
			- Recording a devices normal behaviours to detect or see any anomalies (weird behaviours happening on it that don't normally happen)
- Endpoint Log Analysis
	- Event Correlation - identifies significant relationships from multiple log sources such as application logs, endpoint logs, and network logs. \
		- Identifying significant relationships between:
			- application logs
			- endpoint logs
			- network logs
		- Events from different channels via logs
	- Deals identifying significant artefacts co-existing from different log sources and connecting each related artefact. 
		- For example - a network connection log may exist in various log sources such as Sysmon logs (Event ID 3: Network Connection) and Firewall Logs. 
		- The Firewall log may provide:
			- The source and destination IP
			- Source and destination Port
			- Protocol
			- Action taken
		- Sysmon logs may give the process that invoked the connection and the user running the process. 
	- With this information we can connect the dots from the two data sources:
		- Source and Destination IP
		- Source and Destination Port
		- Action taken
		- Protocol that was used
		- Process name
		- User Account
		- Machine Name
- Baselining
	- Knowing what is expected to be normal and/or ordinary behaviour
	- A large amount of data gathering would be required to gather normal patterns of what otherwise would be
		- normal User Behaviour/Activities
		- Network traffic across infrastructure
		- Processes that would be running on a 'normal' day between all the machines owned and monitored by the organisation
	- Using the baseline as a reference, we can quickly determine irregular beviours, actions that could threaten the organisation
	- For example - normal working hours are 9-5 Mon-Fri in California, USA. Someone has logged in on a Thursday morning at 03:00 local (Cali) time, from Uzbekistan.
- DFIR
	- Digital Forensics Incidence and Response
- SOC
	- Security Operations Centre
- Digital Forensics
	- Physical devices and scrubbing them
	- System access logs, and scrubbing through them
	- Public-sector Investigations
		- Carried out by government and law enforcement agencies. (Crime or civil investigations)
	- Public-sector Investigations
		- Carried out by private corporate bodies, assigned to a private investigator and/or team
		- Triggered by corporate policy violations in most cases..
	- Process:
		- Acquire evidence
			- Laptops, storage devices, digital cameras
			- Keeping to the law and what is allowed/identified to be investigated
		- Establish a Chain of Custody
			- To ensure that authorised investigators have had access to evidence and that no one else could have tampered with it/them
		- Secure Containers
			- Placing evidence in secure containers
			- So as to the devices not getting damaged
			- Faraday cages so as to not allow remote formatting or access to said devices
		- Transport to the digital forensics lab
			- Create copies of the evidence
			- Start processing and working on the copies rather than the originals
	- Ken Zatyko, Director of the Defense Computer Forensics Laboratory
		- Proper Search Authority
		- Chain of Custody
		- Validation with Mathematics
		- Use of Validated Tools
		- Repeatability
		- Reporting
- Penetration Testing (Ethical)
	- Ethically-driven attempt to test and analyse the security defenses to protect these assets and pieces of information. 
	- Involves using the same tools, techniques, and methodologies that someone with malicious and ill-intent would use and is similar to an audit (System Audit)
	- PenTesters will often be faced with morally questionable decisions during their work - being exposed to sensitive data, what to do? 
		- To phish or not to phish? (what do we need to find out? What will we do with the vulnerabilities that are exposed to us? )
		- The hats:
			- White
			- Grey
			- Black
	- Rules of Engagement
		- A document
		- Responsible for deciding how the pentest engagement is carried out
		- Methodologies:
			- Information gathering
			- Enumeration/Scanning
			- Exploitation
			- Privilege Escalation
			- Post-Exploitation
		- OSSTMM (Open Source Security Testing Methodology Manual)
		- OWASP (Open Web Application Security Project)
		- NIST Cybersecurity Framework
		- NCSC (National Cyber Security Centre) CAF (Cyber Assessment Framework)
			The above are general frameworks/methodologies that are followed
	- Types of Testing
		- Black-box
			- No knowledge of the system and/or code involved
			- The tester will normally act as a normal user
			- Tends to take a large amount of time spent during information gathering and enumeration phases to gain a solid understanding of the attack surface of the target(s) involved
		- Grey-box
			- Popular for things such as PenTesting
			- Combination of black and white box testing
			- Tester will normally have some (or limited) knowledge of the system(s) involved
			- Often chosen for well-hardened attack surfaces
		- White-box
			- Normally carried out by a software dev
			- Tester will have full knowledge of the system(s) involved
- Reverse Engineering Malware Analysis
- Authentication Enumeration
	- Digging into the details that aren't immediately visible but are crucial for a comprehensive security assessment
	- Fundamental aspect of security testing
	- Focusing specifically on the mechanisms that protect sensitive aspects of web apps
	- Involves inspecting authentication components ranging from uname validation to pword policies and session management
	- Involves stripping away a systems' defenses layer by layer, revealing the underlying logic of a function or a system
	- Authentication Mechanisms
		- How users are verified
		- How credentials are stored and handled
		- Identifying potential weaknesses that could be exploited
	- Identifying Valid Usernames
		- Confirming valid unames
		- Knowing one can allow you to focus solely on cracking the password
			- Dramatically reducing the effort required in subsequent attacks
		- Analysing:
			- registration processes
			- Password reset features
			- Responses to login attempts
			for example, "this account doesn't exist" "incorrect password" (can help identify a valid username)
	- Learning about Password Policies
		- Pword policies dictate the complexity and structure of user passwords, which directly impact the approach and tools you might use to breach them
		- By examining the creation and reset guidelines, you can infer the level of complexity expected and adjust your brute-force strategies accordingly
			- If a system enforces password that includes symbols, numbers, uppercase letters
				- You can tailor your attacks to generate passwords that align with those policies
	- Common locations to enumerate
		- Registration pages
			- Immediate feedback on account availability
				- Potential exploit
				- Testinga list of potential usernames or emails, generating a list of users without gaining access to the database
		- Password Reset Features
			- Password reset functions are intended to help users recover access to their accounts by entering their account details and getting reset instructions
			- Similar to registration page potential flaw
		- Verbose errors
			- Detailed errors such as 'uname not found' or 'incorrect password' can define a list of valid usernames
			- Internal Paths
				- Reveal file paths and directory structures of the application server which might contain config files or keys that aren't visible to a normal user
			- Database Details
				- Revealing table names, column details
			- User Information
				- Can hint at usernames or other personal data
			- Inducing Verbose Errors
				- Invalid Login Attempts
					- Intentionally entering incorrect unames or pwords, adversaries can trigger error messages that help distinguish between valid and invalid unames
				- SQL Injection
					- Entering SQL commands into entry fields with the potential that the system will provide and answer to the SQL instruction given
					- Identify database structure
					- Intentional errors in queries to see if the response will throw something of use
				- File Inclusion/Path Traversal
					- Adversaries manipulating file paths in the attempt to access restricted files
						- ie ../../../../ where am I now? 
				- Form Manipulation
					- In an attempt to see how the backend works or to pull sensitive information
					- Identifying what an input masks regulations are
				- Application Fuzzing
					- Sending random inputs to parts of the application to see how it will react can identify vulnerabilities or flaws in the system
					- BurpSuite can automate the process
		- Password Reset Flow Vulnerabilities
			- Email-based Reset
				- When a password reset request is made, the application will send an email containing a reset link to the users registered email address
				- The user would then normally click this link, which would point them to a page where they can enter a new password ... You knwo the drill
				- This method relies on the security of the users email account and the secrecy of the link or token sent
			- Security Question-based Reset
				- Ivolves the user answering a series of pre-configured security questions they had set up when creating the account
				- If answered correctly, the system will allow the password for the account to be reset
				- If the adversary knows those answers, by gaining access to PII (Personally Identifiable Information), then GG
			- SMS-based Request
				- Uses an SMS as opposed to an email
				- SIM Swap vulnerability (however in some countries this has been a process that has been locked down quite heavily by some Service Providers)
			- Vulnerabilities:
				- Predictable Tokens
					- 
				- Token Expiration Issues
				- Insufficient Validation
				- Information Disclosure
				- Insecure Transport
	- Basic Authentication
		- Straightforward method when securing access to devices. 
		- Only a username and password (no MFA, tokens etc)
		- ie Routers use Basic Auth (there's no need for the overhead of a more complex authentication system as the admin console will mainly be used for config purposes only.)
		- Suitable for environments where session management and user tracking are not required or are managed in a different manner
		- HTTP Basic Authentication
			- RFC 7617
			- uname|pword transported in base64 within the HTPP Authorisation Header
			- Not secure over non-HTTPS connections
			- (only encoded, not decrypted - note, base64)
			- Weak creds can be brute forced.
			- the base64 encoding is of 'username:password' 
	- Effective Enumeration:
		- Crucial for identifying potential vulnerabilities in web apps
		- Using the right tools, techniques, we can reveal valuable information that can aid in planning further potential attacks
	- Brute Force Efficiency:
		- Optimizing brute force attacks involves creating intelligent, diverse wordlists, managing attack parameters, avoiding detections mechanisms like rate limiting and account lockouts
	- Ethical Responsibility:
		- Always conduct enumeration and pentesting with explicit permission from the system owner(s)
		- These listings above and throughout all content in this material are for the purposes of understanding how to better protect a system. All information held within is publicly available. 